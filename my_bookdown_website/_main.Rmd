--- 
title: "A Metanalysis of Beaver Translocation Methods to Inform Establishment Success and Beaver Management Policy"
author: "Molly Alves"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
bibliography: [book.bib, packages.bib]
#url: your book url like https://bookdown.org/yihui/bookdown

#cover-image: knitr::include_graphics("/Users/mollyalves/MASTERS/Bookdown/my_bookdown_website/DSC_9074.jpg")

description: |
  This is the final bookdown document for Reproducible Data Science 2023.
link-citations: yes
github-repo: rstudio/bookdown-demo
---

# About

This book has been prepared for the Reproducible Data Science 2023 final assignment and was written in **Markdown**.

<!--chapter:end:index.Rmd-->

# Project Organization

For my final semester project, I will be establishing a database that will enable me to manage, clean, and code my incoming data for eventual import into R for meta-analysis. I expect to begin collecting data in March/April so would like to have this database created and have a structured plan for data input, cleaning, and coding.

```{r, eval=FALSE, echo=FALSE}
library(knitr)
```

```{r my-fig, fig.cap= "Relational Database Diagram", fig.align='center', out.width='100%', eval=TRUE, echo=FALSE}
knitr::include_graphics("/Users/mollyalves/MASTERS/Bookdown/Images/ReproDatReposStruc", rel_path= getOption("knitr.graphics.rel_path", TRUE))
```

I chose this directory structure so that it is nested in my root directory for easy import into R and for version tracking with Git. For organizational purposes, I placed it in my MASTERS folder, under the folder MetaAnalysis so that all files associated with my degree and proposed meta-analysis are in one, easy to locate folder. I chose to add folders for Code, Data, Figures, Manuscripts, README, and Results at your recommendation so that I can track and version control all incoming data, code that is created, and eventual Figures, Results, and Manuscripts that are developed from the eventual analysis. The README folder will track all inputs to these folders as my metadata. The MetaAnalysis folder can then be zipped and shared at the conclusion of the study for anyone that may want to replicate my methods.

# Progress

The Google Forms Survey was lauched two weeks ago. So far, I have received 22 responses. I will use this as test data and manipulate it to fit my database structure.

## Load Raw Data from Survey

```{r, eval=TRUE, echo=FALSE}
library(tidyverse)
```

```{r, eval=TRUE, echo=FALSE}
library(readxl)
```

TestData <- readxl::read_excel ("GoogleFormRespTEST.xlsx")
TestData


<!--chapter:end:01-About.Rmd-->

# Database Structure

The package `DBI` was used to create the database and tables.

## Database Creation

metabeaver_db <- dbConnect(RSQLite::SQLite(), "../../MASTERS/MetaAnalysis/Data/metabeaver.db")

## Tables

responses, 
projects, 
questions, 
answers_text, 
answers_mc, 
answers_ls, 
answers_ca.

### responses 
 
    - This table will contain all responses submitted to the Google Forms survey.

```{r, eval = FALSE, echo = TRUE}
    dbExecute(metabeaver_db, "CREATE TABLE responses (
          resp_id varchar (5) NOT NULL PRIMARY KEY,
          FOREIGN KEY(proj_id) REFERENCES projects(proj_id)
          );")
```

### projects

    - This table will contain information about all respondents projects and contact information.

```{r, eval = FALSE, echo = TRUE}
    dbExecute(metabeaver_db, "CREATE TABLE projects (
          proj_id varchar(5) PRIMARY KEY
          proj_email text,
          proj_name text,
          proj_agency varchar (15) CHECK (proj_agency IN ('State', 'Federal', 'Tribal', 'Non Profit', 'For Profit')),
          proj_501c3 varchar (15) CHECK (proj_501c3 IN ('501c3', 'fiscal sponsor')),
          proj_called text,
          proj_lead varchar (5) CHECK (proj_lead IN ('yes', 'no')),
          proj_lead_alt text,
          proj_location text
          );")
```

### questions

    -This table will contain all of the questions and types of questions that will be asked in the Google Forms survey.

```{r, eval = FALSE, echo = TRUE}
    dbExecute(metabeaver_db, "CREATE TABLE questions (
          quest_id varchar text PRIMARY KEY
          questions text,
          quest_type varchar (5) CHECK (quest_type IN ('text', 'mc', 'ls', 'ca')),
          );")
```

### answers_text

    -This table will contain all answers to short and long answer questions.

```{r, eval = FALSE, echo = TRUE}
    dbExecute(metabeaver_db, "CREATE TABLE answers_text (
          text_id text PRIMARY KEY,
          answer text,
          FOREIGN KEY(resp_id) REFERENCES responses(resp_id)
          FOREIGN KEY(quest_id) REFERENCES questions(quest_id)
          );")
```

### answers-mc

    -This table will contain all answers to multiple choice questions.

```{r, eval = FALSE, echo = TRUE}
    dbExecute(metabeaver_db, "CREATE TABLE answers_mc (
          mc_id text PRIMARY KEY,
          answer text,
          FOREIGN KEY(resp_id) REFERENCES responses(resp_id)
          FOREIGN KEY(quest_id) REFERENCES questions(quest_id)
          );")
```

### answers_ls

    -This table will contain all answers to linear scale questions.

```{r, eval = FALSE, echo = TRUE}
    dbExecute(metabeaver_db, "CREATE TABLE answers_ls (
          ls_id text PRIMARY KEY,
          answer text,
          FOREIGN KEY(resp_id) REFERENCES responses(resp_id)
          FOREIGN KEY(quest_id) REFERENCES questions(quest_id)
          );")
```

### answers_ca

    -This table will contain all answers to check all that apply questions.

```{r, eval = FALSE, echo = TRUE}
    dbExecute(metabeaver_db, "CREATE TABLE answers_ca (
          ca_id text PRIMARY KEY,
          answer text,
          FOREIGN KEY(resp_id) REFERENCES responses(resp_id)
          FOREIGN KEY(quest_id) REFERENCES questions(quest_id)
          );")
```


## Relational Database Diagram

```{r, eval=FALSE, echo=FALSE}
library(knitr)
```

```{r my-fig, fig.cap= "Relational Database Diagram", fig.align='center', out.width='100%', eval=TRUE, echo=FALSE}
knitr::include_graphics("/Users/mollyalves/MASTERS/Bookdown/my_bookdown_website/ReproDat_Assignment3.pdf", rel_path= getOption("knitr.graphics.rel_path", TRUE))
```

<!--chapter:end:02-Database_Structure.Rmd-->

# References

TO BE EDITED FOR FINAL SUBMISSION

## Footnotes

Footnotes are put inside the square brackets after a caret `^[]`. Like this one ^[This is a footnote.]. 

## Citations

Reference items in your bibliography file(s) using `@key`.

For example, we are using the **bookdown** package [@R-bookdown] (check out the last code chunk in index.Rmd to see how this citation key was added) in this sample book, which was built on top of R Markdown and **knitr** [@xie2015] (this citation was added manually in an external file book.bib). 
Note that the `.bib` files need to be listed in the index.Rmd with the YAML `bibliography` key.


The RStudio Visual Markdown Editor can also make it easier to insert citations: <https://rstudio.github.io/visual-markdown-editing/#/citations>

<!--chapter:end:03-References.Rmd-->

